<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>基金/股票实时估值</title>
    <link rel="stylesheet" href="/static/style.css" />
  </head>
  <body>
    <main class="container">
      <header class="header">
        <div>
          <h1>基金/股票实时估值</h1>
          <p>实时展示组合市值与盈亏，并支持持仓增删改</p>
        </div>
        <div class="header-meta">
          <div>刷新间隔：<span id="refresh-seconds">{{ refresh_seconds }}</span>s</div>
          <div>币种：<span id="base-currency">{{ base_currency }}</span></div>
          <div>更新时间：<span id="updated-at">--</span></div>
        </div>
      </header>

      <section class="action-card">
        <h2>新增 / 修改持仓</h2>
        <form id="position-form" class="action-form">
          <label>
            资产类型
            <select id="position-asset-type" required>
              <option value="fund">基金</option>
              <option value="stock">股票</option>
            </select>
          </label>
          <label>
            代码
            <input id="position-code" type="text" placeholder="基金示例 161725 / 股票示例 sh600519" required />
          </label>
          <label>
            名称（可选）
            <input id="position-name" type="text" placeholder="可留空，自动显示代码或行情名称" />
          </label>
          <label>
            持仓份额/股数
            <input id="position-units" type="number" min="0.0001" step="0.0001" required />
          </label>
          <label>
            成本价
            <input id="position-cost-price" type="number" min="0.0001" step="0.0001" required />
          </label>
          <div class="form-actions">
            <button id="position-submit" type="submit">新增持仓</button>
            <button id="position-cancel" type="button" class="secondary hidden">取消编辑</button>
          </div>
        </form>
        <p id="position-message" class="hint"></p>
      </section>

      <section class="action-card">
        <h2>按基金金额导入</h2>
        <form id="fund-import-form" class="action-form compact">
          <label>
            基金代码
            <input id="fund-code" type="text" placeholder="例如 161725" required />
          </label>
          <label>
            持仓金额
            <input id="fund-amount" type="number" min="0.01" step="0.01" placeholder="例如 10000" required />
          </label>
          <label>
            名称（可选）
            <input id="fund-name" type="text" placeholder="可留空，自动读取" />
          </label>
          <button id="import-button" type="submit">导入</button>
        </form>
        <p id="import-message" class="hint"></p>
      </section>

      <section class="summary-grid">
        <article class="card">
          <h2>总成本</h2>
          <p id="total-cost">--</p>
        </article>
        <article class="card">
          <h2>总市值</h2>
          <p id="total-market">--</p>
        </article>
        <article class="card">
          <h2>总盈亏</h2>
          <p id="total-pnl">--</p>
        </article>
        <article class="card">
          <h2>成功/失败</h2>
          <p id="quote-status">--</p>
        </article>
      </section>

      <section class="table-wrap">
        <table>
          <thead>
            <tr>
              <th>资产</th>
              <th>代码</th>
              <th>持仓</th>
              <th>成本价</th>
              <th>现价</th>
              <th>涨跌幅</th>
              <th>成本</th>
              <th>市值</th>
              <th>盈亏</th>
              <th>状态</th>
              <th>操作</th>
            </tr>
          </thead>
          <tbody id="positions-body"></tbody>
        </table>
      </section>
      <p id="error-message" class="error hidden"></p>
    </main>

    <script>
      window.APP_CONFIG = {
        refreshSeconds: Number("{{ refresh_seconds }}"),
        baseCurrency: "{{ base_currency }}",
      };
    </script>
    <script src="/static/app.js"></script>
  </body>
</html>
